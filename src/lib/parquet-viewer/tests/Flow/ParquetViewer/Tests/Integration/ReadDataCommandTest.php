<?php declare(strict_types=1);

namespace Flow\ParquetViewer\Tests\Integration;

use Flow\ParquetViewer\Application;
use PHPUnit\Framework\TestCase;
use Symfony\Component\Console\Tester\ApplicationTester;

final class ReadDataCommandTest extends TestCase
{
    public function test_read_data_command() : void
    {
        $application = new Application();
        $application->setAutoExit(false);
        $application->setCatchExceptions(false);

        $path = \realpath(__DIR__ . '/../../Fixtures/flow.parquet');

        $tester = new ApplicationTester($application);
        $tester->run([
            'command' => 'read:data',
            'file' => $path,
        ]);

        $this->assertSame(0, $tester->getStatusCode());
        $this->assertStringContainsString(
            <<<'OUTPUT'
+---------+------------+---------------------+-------+-----------------+--------------+---------------------------------------------------+---------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
| boolean |      int32 |               int64 | float |          double |      decimal |                                            string |                      date |                  datetime |                                                                                                                                                                                                                                                                                  time |                                                                                                                                                                                                                     list_of_datetimes |                                         map_of_ints |                                                                                                                                                                                                                                                                                                                                                                                                                                                list_of_strings |                     struct_flat |
+---------+------------+---------------------+-------+-----------------+--------------+---------------------------------------------------+---------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
|    true |  601197183 | 1252452733354460846 | 10.25 |          0.3608 |       458.78 |    Et itaque beatae sunt consequatur accusantium. | 2023-08-16T00:00:00+00:00 | 2023-07-18T01:27:45+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-08-09 12:16:12.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-04-15 16:15:01.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-02-14 21:32:02.000000","timezone_type":1,"timezone":"+00:00"}] |   {"a":"15173348","b":"1996606959","c":"882761739"} |                                                                                                                                                                                                                                                                                                           ["Ea quia ut numquam sed atque.","Voluptate voluptatibus aut tempore et.","Aut autem nostrum non dolores.","Debitis temporibus fugiat harum nulla."] |  {"id":"1","name":"name_00001"} |
|    true | 1898860246 |   80604967340828891 | 10.25 |   327433.404179 |      3284.82 | Et consequuntur maiores autem cupiditate ratione. | 2023-09-23T00:00:00+00:00 | 2023-02-05T16:56:28+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-09-30 00:36:27.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-05-06 17:54:05.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-10-19 18:11:05.000000","timezone_type":1,"timezone":"+00:00"}] | {"a":"1533619681","b":"675529566","c":"1059874100"} |                                                                           ["Debitis fugiat commodi maiores.","Laudantium aut maxime aut et quis.","Doloribus quia quasi rerum soluta.","Quasi eius dignissimos molestiae nemo et.","Et officia similique est quo.","Illum sit est aut aperiam dolor.","Ex minima enim sint error vitae.","Molestiae consequatur omnis ea suscipit.","Enim non eum est corrupti harum velit.","Fuga quis dolorem quibusdam a."] |  {"id":"2","name":"name_00002"} |
|   false | 1315048828 | 3129070533160172325 | 10.25 |    2203746.6483 |    569329.21 |    Aut est optio earum tenetur inventore numquam. | 2023-05-30T00:00:00+00:00 | 2023-07-15T05:24:48+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-03-31 00:00:54.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-03-22 15:16:55.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-10-28 19:21:35.000000","timezone_type":1,"timezone":"+00:00"}] | {"a":"1749103854","b":"1282277325","c":"928399147"} | ["Non voluptates aut eos aliquid consequatur est.","Eos dolorem voluptates quidem voluptate.","Mollitia magnam asperiores delectus et.","Reiciendis aut rerum minus.","Possimus repudiandae qui explicabo magni unde.","Sunt aut minima quos sint sequi enim.","Qui quia rerum nemo rerum omnis quo veritatis et.","Molestiae itaque et ea quaerat at laboriosam eos.","Non et eos perspiciatis nihil ut est consequatur.","Ipsa delectus soluta nemo atque."] |  {"id":"3","name":"name_00003"} |
|   false | 1558719417 | 6878707872420020635 | 10.25 |          1.6939 |  25955397.64 |                  Dolorem magnam qui deleniti non. | 2023-08-13T00:00:00+00:00 | 2023-03-24T21:14:45+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-01-09 19:51:49.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-01-01 15:32:58.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-02-07 10:13:59.000000","timezone_type":1,"timezone":"+00:00"}] | {"a":"1720840905","b":"471316142","c":"1101044951"} |                                                                                                                                                                                                                                                                                                                                             ["Nihil quod perspiciatis autem ab non facilis.","Molestias beatae iusto et repellendus.","Aut natus dolor enim."] |  {"id":"4","name":"name_00004"} |
|    true | 1012067503 | 8967249410708780846 | 10.25 | 1750536.8304657 |         8.25 |                  Aut velit alias enim voluptatem. | 2023-10-16T00:00:00+00:00 | 2023-10-05T18:39:53+00:00 |      DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 0 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-01-01 12:47:59.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-01-13 13:51:30.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-04-12 04:22:17.000000","timezone_type":1,"timezone":"+00:00"}] |  {"a":"811892167","b":"975078272","c":"2018268897"} |                                                                                                                                                                                                                                                                                                                                                                       ["Voluptas eos quisquam unde soluta.","Nostrum debitis sed deserunt nostrum aut ullam."] |  {"id":"5","name":"name_00005"} |
|    true |   28238480 | 3652472020703415644 | 10.25 |  22556.65651872 |     41735.05 |     Ipsam voluptatem ipsum consequuntur deserunt. | 2023-05-15T00:00:00+00:00 | 2023-06-22T00:51:17+00:00 |      DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 0 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-05-11 10:13:54.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-09-18 09:08:19.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-06-02 05:25:55.000000","timezone_type":1,"timezone":"+00:00"}] |   {"a":"2124941571","b":"271637908","c":"43689029"} |                                          ["Ut sed debitis delectus officia.","Quo facere qui hic in quam omnis laudantium.","Et fugiat harum nihil in saepe.","Neque soluta nam qui ad. Id et ratione ex id.","Esse repudiandae praesentium natus eum.","Quis veniam voluptatem amet eos.","Maiores assumenda quaerat aperiam soluta.","Repudiandae sunt distinctio sint ut odio alias.","Fugit sequi at laudantium eveniet id.","Est ducimus eum sit ea ut."] |  {"id":"6","name":"name_00006"} |
|    true | 1294233247 | 7357477648138228591 | 10.25 |          237157 | 185585581.49 |        Voluptas itaque cupiditate nesciunt ipsum. | 2023-01-09T00:00:00+00:00 | 2023-08-09T21:26:24+00:00 |      DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 0 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-09-04 13:21:06.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-05-10 09:22:45.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-03-14 07:17:32.000000","timezone_type":1,"timezone":"+00:00"}] | {"a":"429815988","b":"1930303723","c":"1712087310"} |                                                                                                                                                                                                                                                                                                                         ["Nihil modi voluptatum explicabo qui at autem ut.","Omnis similique reiciendis totam aut qui.","Officiis rem omnis ea debitis odit."] |  {"id":"7","name":"name_00007"} |
|   false | 1250913218 | 7983709812438780296 | 10.25 |  25667989.42954 |   3079052.64 |                          Minus autem est eos est. | 2023-07-10T00:00:00+00:00 | 2023-08-28T18:12:31+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-02-03 23:32:51.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-06-10 06:52:42.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-10-03 05:43:09.000000","timezone_type":1,"timezone":"+00:00"}] |   {"a":"412214284","b":"781759602","c":"514441792"} |            ["Consectetur nobis ex illo aliquam.","Eum iste aut omnis autem sit in.","Optio est modi aliquid non itaque.","Qui aliquid facilis enim optio aut fuga.","Aliquid recusandae provident ipsam non deleniti.","Mollitia reiciendis illum ab odio.","Officia laudantium eaque rem non ipsa omnis.","Voluptatibus eveniet quo saepe.","Omnis id amet aut laborum.","Et a deserunt est minus vero.","Sequi vel recusandae at architecto vero corrupti."] |  {"id":"8","name":"name_00008"} |
|    true | 2105356816 | 8855288021139833847 | 10.25 |         0.93007 |      2433.84 |                 Fuga aut rerum et deserunt magni. | 2023-08-21T00:00:00+00:00 | 2023-03-27T19:05:04+00:00 | DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 1.0E-6 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-02-07 16:58:11.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-07-14 22:21:43.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-05-29 02:13:17.000000","timezone_type":1,"timezone":"+00:00"}] | {"a":"1268800792","b":"124276405","c":"1898353016"} |                                                                                                                                                                                                                                                                                                                                                 ["Labore ratione sunt dolorum consectetur.","Ducimus maxime voluptatem minus.","Velit illo eum aut repellat."] |  {"id":"9","name":"name_00009"} |
|    true | 1314291690 | 7670636630642412419 | 10.25 |      73.3677088 |  20244591.11 |             Voluptate non sit amet maxime itaque. | 2023-10-07T00:00:00+00:00 | 2023-09-15T08:41:32+00:00 |      DateInterval Object( [y] => 0 [m] => 0 [d] => 0 [h] => 2 [i] => 0 [s] => 0 [f] => 0 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0) | [{"date":"2023-05-25 21:38:01.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-03-07 11:42:20.000000","timezone_type":1,"timezone":"+00:00"},{"date":"2023-01-27 15:28:32.000000","timezone_type":1,"timezone":"+00:00"}] |  {"a":"929312481","b":"2083842496","c":"783646899"} |                                                                                                                                                                                                                                                                                                                                 ["Iusto quam et est quia.","Repellat et libero cupiditate vitae eveniet.","Pariatur nulla dolor nostrum necessitatibus amet."] | {"id":"10","name":"name_00010"} |
+---------+------------+---------------------+-------+-----------------+--------------+---------------------------------------------------+---------------------------+---------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------+
10 rows
OUTPUT,
            $tester->getDisplay()
        );
    }
}
